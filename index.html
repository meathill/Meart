<!DOCTYPE html>
<html lang="zh-cmn-Hans">
<head>
  <meta charset="UTF-8">
  <title>Meart: a static site builder</title>

  <link rel="stylesheet" href="node_modules/tether/dist/css/tether.min.css">
  <link rel="stylesheet" href="node_modules/bootstrap/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="node_modules/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="css/screen.css">
</head>
<body>
<div id="app">
  <router-view></router-view>
</div>

<script type="text/x-template" id="home-template">
  <div id="home">
    <aside>
      <router-link to="/preview" class="btn btn-secondary btn-block" title="查看网站">
        <i class="fa fa-home"></i><br>
        查看网站
      </router-link>
      <router-link to="/articles" class="btn btn-secondary btn-block" title="相册">
        <i class="fa fa-photo"></i><br>
        相册
      </router-link>
      <router-link to="/config" class="btn btn-secondary btn-block" title="设置">
        <i class="fa fa-cogs"></i><br>
        设置
      </router-link>
      <router-link to="/help" class="btn btn-outline-secondary btn-block secondary" title="帮助"><i class="fa fa-question"></i></router-link>
    </aside>
    <router-view class="container-fluid">

    </router-view>
  </div>
</script>

<script type="text/x-template" id="welcome-template">
  <div class="welcome-panel col-sm-10 offset-sm-1 col-md-8 offset-md-2">
    <h2>欢迎使用 Meart</h2>
    <hr>
    <form class="carousel slide" data-ride="carousel" data-interval="0" data-keyboard="false" id="welcome-wizard" v-on:submit.prevent="onSubmit">
      <div class="carousel-inner" role="listbox">
        <div class="carousel-item active">
          <p class="lead">Meart 是一个免费工具，试图帮助设计师、摄影师快捷方便的创建个人作品网站。Meart 尽量将技术细节隐藏起来，所有过程均通过图形界面操作来实现。最终网站托管在免费 CDN 上。</p>
          <p>接下来，请跟随向导指引，完成网初始化。</p>
          <p class="t-a-c"><a href="#welcome-wizard" data-slide="next" role="button" class="btn btn-primary btn-lg carousel-control"><i class="fa fa-cog"></i> 开始</a></p>
        </div>
        <div class="carousel-item">
          <div class="form-group row">
            <label class="col-sm-2 col-form-label" for="site-title">网站名称</label>
            <div class="col-sm-10">
              <input class="form-control" name="site-title" id="site-title" placeholder="网站名称，比如“我的作品”" v-model="siteTitle">
            </div>
          </div>
          <div class="form-group row">
            <label class="col-sm-2 col-form-label" for="site-desc">网站简介</label>
            <div class="col-sm-10">
              <textarea class="form-control" name="site-desc" id="site-desc" rows="3" placeholder="网站描述，在某些主题中会显示，主要用作被搜索时展示" v-model="siteDesc">

              </textarea>
            </div>
          </div>
          <div class="form-group row">
            <label class="col-sm-2 col-form-label">网站图标</label>
            <div class="col-sm-10">
              <p class="help-block" v-if="siteIcon">
                <img class="rounded img-thumbnail" :src="siteIcon" width="80" height="80">
              </p>
              <input type="file" class="hide" id="site-icon" @change="onSelectFile">
              <label class="btn btn-secondary" for="site-icon">
                <i class="fa fa-picture-o"></i>
                选择图片（png，ico）
              </label>
              <p class="help-block text-muted"><small>(可选)</small></p>
            </div>
          </div>
          <div class="form-group t-a-r">
            <a href="#welcome-wizard" data-slide="next" role="button" class="btn btn-primary btn-lg carousel-control"><i class="fa fa-chevron-right"></i></a>
          </div>
        </div>
        <div class="carousel-item">
          <label>请选择模板：</label>
          <div class="form-group row theme-list">
            <input type="radio" name="site-theme" value="default" id="theme-default" class="hide" v-model="siteTheme">
            <label class="col-sm-6" for="theme-default">
              <div class="card">
                <img class="card-img-top" src="img/theme/default.svg" alt="默认主题">
                <div class="card-block">
                  <p class="card-text">默认主题。暂时只有这一个，未来会添加。</p>
                </div>
              </div>
            </label>
          </div>
          <div class="form-group t-a-r">
            <button class="btn btn-primary btn-lg"><i class="fa fa-check"></i> 好了，开始吧</button>
          </div>
        </div>
      </div>
    </form>
  </div>
</script>

<script type="text/x-template" id="preview-template">
  <div id="preview">
    <header>
      <h2>预览网站</h2>
      <p>上次生成时间：<time :datetime="publishTime | toDate" v-if="publishTime">{{publishTime | toMoment}}</time> |
        最近修改时间：<time :datetime="lastModifiedTime | toDate" v-if="lastModifiedTime">{{lastModifiedTime | toMoment}}</time>
      </p>
      <div class="button-group" role="group" aria-label="发布操作">
        <a href="#publish-modal" class="btn btn-primary" data-toggle="modal"><i class="fa fa-archive"></i> 发布网站</a>
        <button type="button" class="btn btn-success"><i class="fa fa-cloud-upload"></i> 上传到服务器</button>
      </div>
    </header>
    <iframe src="output/index.html" v-if="publishTime"></iframe>
    <div class="alert alert-warning" v-else>
      <p>您还没有生成过网站页面，无法提供预览效果。</p>
      <a href="#publish-modal" class="btn btn-primary btn-lg" data-toggle="modal"><i class="fa fa-archive"></i> 立刻发布网站</a>
    </div>
  </div>
</script>

<script type="text/x-template" id="config-template">
  <div id="config">
    <h2>设置</h2>
    <hr>
    <ul class="nav nav-tabs" role="tablist">
      <li class="nav-item">
        <a href="#site-config" class="nav-link active" data-toggle="tab" role="tab">
          <i class="fa fa-info-circle"></i> 网站信息
        </a>
      </li>
      <li class="nav-item">
        <a href="#site-server" class="nav-link" data-toggle="tab" role="tab">
          <i class="fa fa-server"></i> 服务器信息
        </a>
      </li>
    </ul>
    <div class="tab-content">
      <div id="site-config" class="tab-pane active"role="tabpanel">
        <div class="settings">
          <form>
            <div class="form-group row">
              <label class="col-sm-2 col-form-label" for="site-title">网点名称</label>
              <div class="col-sm-10">
                <input class="form-control" id="site-title" v-model="siteTitle">
              </div>
            </div>
            <div class="form-group row">
              <label class="col-sm-2 col-form-label" for="site-desc">网站简介</label>
              <div class="col-sm-10">
                <textarea class="form-control" id="site-desc" v-model="siteDesc" rows="2"></textarea>
              </div>
            </div>
            <div class="form-group row">
              <label class="col-sm-2 col-form-label" for="site-icon">网站图标</label>
              <div class="col-sm-2">
                <img v-if="siteIcon" :src="siteIcon" class="img-thumbnail site-icon">
              </div>
            </div>
            <div class="form-group row">
              <label class="col-sm-2 col-form-label">网站模板</label>
              <div class="col-sm-10">
                <div class="row">
                  <div class="col-sm-4">
                    <div class="card">
                      <img class="card-img-top img-fluid" src="img/theme/default.svg" alt="默认模板">
                      <div class="card-block">
                        <h4 class="card-title">默认主题</h4>
                        <p class="card-text">暂时只有这个主题</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </form>
        </div>
      </div>
      <div id="site-server" class="tab-pane" role="tabpanel">
        <form>
          <div class="form-group row">
            <label class="col-sm-2 col-form-label" for="server-name">服务器名称</label>
            <div class="col-sm-10">
              <input class="form-control" id="server-name" v-model="server.name">
            </div>
          </div>
          <div class="form-group row">
            <label class="col-sm-2 col-form-label" for="ACCESS_KEY">Access Key</label>
            <div class="col-sm-10">
              <input class="form-control" id="access_key" v-model="server.ACCESS_KEY">
            </div>
          </div>
          <div class="form-group row">
            <label class="col-sm-2 col-form-label" for="SECRET_KEY">Secret Key</label>
            <div class="col-sm-10">
              <input class="form-control" id="secret_key" v-model="server.SECRET_KEY">
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</script>

<script type="text/x-template" id="article-list-template">
  <div id="article-list" class="article-list article">
    <h2>相册</h2>
    <hr>
    <ul class="list row">
      <li v-for="article in isVisible(articles)" class="col-sm-4 single-article">
        <a :href="getHref(article.id)" class="card">
          <img class="card-img-top img-fluid" :src="article.thumbnail" :alt="article.title" v-if="article.thumbnail">
          <div class="card-block">
            <h4 class="card-title">{{article.title}}</h4>
            <p class="card-text">{{article.description}}</p>
            <small class="text-muted">创建时间：<time :datetime="article.createTime | toDate">{{article.createTime | toMoment}}</time></small><br>
            <small class="text-muted">最后修改：<time :datetime="article.lastModifiedTime | toDate">{{article.lastModifiedTime | toMoment}}</time></small>
          </div>
        </a>
      </li>
      <li class="article add col-sm-4">
        <button type="button" class="btn btn-secondary btn-block" v-on:click="add">
          <i class="fa fa-plus"></i>
        </button>
      </li>
    </ul>
  </div>
</script>

<script type="text/x-template" id="article-template">
  <article class="single article">
    <template>
      <header class="row">
        <div class="col-sm-3 thumbnail">
          <input type="file" class="hide" id="article-thumbnail" @change="onSelectThumbnail">
          <label for="article-thumbnail">
            <img :src="article.thumbnail | defaultThumbnail" class="img-thumbnail">
          </label>
        </div>
        <div class="col-sm-7">
          <editor :origin-value="article.title" @change="onEditorChange('title', $event)">
            <h1>{{article.title}}</h1>
          </editor>
          <editor :origin-value="article.description" @change="onEditorChange('description', $event)">
            <p class="lead">{{article.description}}</p>
          </editor>
          <editor :origin-value="article.url" @change="onEditorChange('url', $event)">
            <p>
              <u><small class="text-muted">http://您的网站/</small>{{article.url}}<small class="text-muted">.html</small></u>
            </p>
          </editor>
          <p class="text-muted">
            <small>创建时间：<time :datetime="article.createTime | toDate">{{article.createTime | toMoment}}</time></small> |
            <small>修改时间：<time :datetime="article.lastModifiedTime | toDate">{{article.lastModifiedTime | toMoment}}</time></small>
          </p>
        </div>
        <div class="col-sm-2">
          <div class="form-group">
            <label for="draft">发布状态</label>
            <select v-model.number="article.status" id="draft" class="form-control fa" v-bind:class="isPublished">
              <option value="0" class="fa-check">&#xf00c 发布</option>
              <option value="1">草稿</option>
            </select>
          </div>
          <editor :origin-value="article.tags" @change="onEditorChange('tags', $event)">
            <p>{{article.tags}}</p>
          </editor>
        </div>
      </header>
      <hr>
      <ul class="row list album">
        <li v-for="(photo, index) in article.album" class="col-sm-4 photo" :class="{ active: photo.isActive }">
          <div class="card">
            <button type="button" class="btn btn-sm btn-secondary delete-button" @click="remove(index)">
              <i class="fa fa-trash"></i>
            </button>
            <img class="card-img-top img-fluid" :src="photo.src" :alt="photo.title">
            <div class="card-block">
              <editor :origin-value="photo.title" @change="onPhotoChange('title', index, $event)">
                <h4 class="card-title">{{photo.title}}</h4>
              </editor>
              <editor :origin-value="photo.title" @change="onPhotoChange('description', index, $event)">
                <p class="card-text">{{photo.description}}</p>
              </editor>
            </div>
          </div>
        </li>
        <li class="col-sm-4 add">
          <label class="btn btn-secondary btn-block">
            <i class="fa fa-plus"></i>
            <input type="file" accept="image/*" @change="onSelectFile">
          </label>
        </li>
      </ul>
    </template>
  </article>
</script>

<script type="text/x-template" id="editor">
<div class="dbl-click-editor" v-bind:class="{ editing: isEditing }" @dblclick="edit">
  <slot></slot>
  <input class="form-control" v-model="value" @blur="editDone" @keyup.enter.prevent="editDone" @keyup.esc="cancel" autofocus>
</div>
</script>

<script type="text/x-template" id="help-template">
  <div id="help">
    <h2>帮助</h2>
    <hr>
    <ul class="nav nav-tabs" role="tablist">
      <li class="nav-item">
        <a class="nav-link active" data-toggle="tab" role="tab" href="#help-detail">帮助</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" data-toggle="tab" role="tab" href="#help-about">关于</a>
      </li>
    </ul>
    <div class="tab-content">
      <div class="tab-pane active" id="help-detail" role="tabpanel">
        <h3>当前版本：</h3>
        <p>0.1.0</p>
      </div>
      <div class="tab-pane" id="help-about" role="tabpanel" v-html="about">

      </div>
    </div>
  </div>
</script>

<div class="modal fade" id="publish-modal" tabindex="-1" role="dialog" aria-labelledby="#publish-modal-label" aria-hidden="true" :class="{ progress: isProgress }" data-backdrop="static" data-keyboard="false">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="关闭" v-if="!isProgress">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title" id="publish-modal-label">发布网站</h4>
      </div>
      <div class="modal-body">
        <template>
          <p>将网站内容发布成静态网页，稍后您可以将网页上传，更新自己的网站。</p>
          <div class="text-xs-center" id="publish-progress-label" v-if="isProgress">当前进度：{{label}}</div>
          <progress class="progress" :value="progress" max="100" aria-describedby="#publish-progress-label" v-if="isProgress"></progress>
          <p>
            <button type="button" class="btn btn-primary btn-lg" @click="start" :disabled="isProgress"><i class="fa fa-play"></i> 开始生成</button>
          </p>
        </template>
      </div>
    </div>
  </div>
</div>

<script>
  if (typeof module === 'object') {
    window.module = module;
    module =undefined;
  }
</script>
<script src="node_modules/jquery/dist/jquery.min.js"></script>
<script src="node_modules/tether/dist/js/tether.min.js"></script>
<script src="node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="node_modules/vue/dist/vue.js"></script>
<script src="node_modules/vue-router/dist/vue-router.js"></script>
<script src="node_modules/vuex/dist/vuex.min.js"></script>
<script src="node_modules/moment/min/moment-with-locales.min.js"></script>
<script src="app.js"></script>
<script>
  if (window.module) {
    module = window.module;
  }
</script>
</body>
</html>